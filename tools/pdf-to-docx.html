<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <meta http-equiv="X-UA-Compatible" content="ie=edge"/>

  <!-- Organization -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "DocPDFHub",
    "url": "https://docpdfhub.com",
    "logo": "https://docpdfhub.com/icon-512.png",
    "sameAs": []
  }
  </script>

  <!-- WebSite -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://docpdfhub.com",
    "name": "DocPDFHub",
    "inLanguage": "en",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://docpdfhub.com/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <title>PDF to Word — Free, No Upload | DocPDFHub</title>
  <meta name="description" content="Convert text-based PDF files to editable Word (DOCX) directly in your browser. No upload, no signup. Extracts text with pdf.js and creates a clean .docx.">

  <link rel="canonical" href="https://docpdfhub.com/tools/pdf-to-docx.html">
  <link rel="alternate" href="https://docpdfhub.com/tools/pdf-to-docx.html" hreflang="x-default">
  <link rel="alternate" href="https://docpdfhub.com/tools/pdf-to-docx.html" hreflang="en">
  <link rel="alternate" href="https://docpdfhub.com/zh/tools/pdf-to-docx.html" hreflang="zh">

  <link rel="stylesheet" href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css"/>
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet"/>

  <!-- i18n & common -->
  <script src="/js/i18n.js" defer></script>
  <script src="/js/common.js" defer></script>

  <!-- PDF.js：用来读取 PDF 文本 -->
  <script src="https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
  <!-- HTML -> DOCX -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.js"></script>

  <style>
    .gradient{background:linear-gradient(90deg,#d53369 0%,#daae51 100%)}
    .dropzone{border:2px dashed #e5e7eb;}
    .drop-active{outline:2px dashed #ec4899; outline-offset:6px; background:#fff7fb}
    #pdfPreview{
      background:#ffffff;
      padding:20px;
      margin-top:16px;
      box-shadow:0 4px 10px rgba(0,0,0,0.05);
      max-height:480px;
      overflow:auto;
      font-size:14px;
      line-height:1.6;
      white-space:pre-wrap;
    }
  </style>

  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#ec4899">

  <!-- AdSense & GA -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4284929103244648"
     crossorigin="anonymous"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-3W6M25B9FL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-3W6M25B9FL');
  </script>
</head>

<body class="text-gray-900 bg-gray-50" style="font-family:'Source Sans Pro',sans-serif;">
  <!-- Nav -->
  <nav class="fixed w-full z-30 top-0 bg-white shadow">
    <div class="w-full max-w-6xl mx-auto flex items-center justify-between px-4 py-3">
      <a class="text-pink-600 font-extrabold text-2xl" href="/"><span data-i18n="common.brand">DocPDFHub</span></a>
      <div class="hidden md:flex items-center space-x-6 text-sm">
        <a href="/" class="text-gray-700 hover:text-pink-600" data-i18n="nav.home">Home</a>
        <a href="/blog/index.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.blog">Blog</a>
        <a href="/tools/pdf-merge.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.merge">Merge PDF</a>
        <a href="/tools/pdf-split.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.split">Split PDF</a>
        <a href="/tools/pdf-compress.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.compress">Compress PDF</a>
        <a href="/tools/pdf-to-jpg.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.tojpg">PDF to JPG</a>
        <a href="/tools/docx-to-pdf.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.topdf">Word to PDF</a>
        <a href="/tools/pdf-to-docx.html" class="text-gray-900 font-semibold" data-i18n="nav.toword">PDF to Word</a>
        <div class="flex items-center space-x-2">
          <button data-lang-btn="en" class="px-2 py-1 rounded hover:bg-gray-100">EN</button>
          <span class="text-gray-300">|</span>
          <button data-lang-btn="zh" class="px-2 py-1 rounded hover:bg-gray-100">中文</button>
        </div>
      </div>
      <!-- mobile lang -->
      <div class="md:hidden flex items-center space-x-2">
        <button data-lang-btn="en" class="px-2 py-1 rounded hover:bg-gray-100">EN</button>
        <button data-lang-btn="zh" class="px-2 py-1 rounded hover:bg-gray-100">中文</button>
      </div>
    </div>
  </nav>
  <div class="pt-20"></div>

  <!-- Hero -->
  <header class="gradient text-white pt-12 pb-10">
    <div class="max-w-6xl mx-auto px-4">
      <p class="uppercase tracking-widest opacity-90 text-sm">PDF TOOLS</p>
      <h1 class="text-4xl md:text-5xl font-extrabold mt-2">PDF to Word</h1>
      <p class="text-white text-opacity-90 mt-2 md:w-3/4">
        Convert text-based PDF files to editable Word (.docx) directly in your browser — no upload, no signup.
      </p>
      <p class="mt-3 text-sm text-white text-opacity-80" data-i18n="common.100_local">
        100% local in your browser • No upload
      </p>
    </div>
  </header>

  <!-- Main -->
  <main class="max-w-6xl mx-auto px-4 py-10">
    <div id="dropZone" class="bg-white border rounded-xl p-6 shadow-sm">
      <div class="text-center">
        <h2 class="text-xl font-bold">Drop a PDF file to convert</h2>
        <p class="text-gray-600 mt-1">
          Works best with text-based PDFs. Scanned/image-only PDFs are not supported (no OCR).
        </p>

        <!-- 拖拽 + 点击上传 -->
        <label for="fileInput" class="block mt-4 p-6 border rounded-xl dropzone cursor-pointer">
          <div class="font-semibold">Drop your PDF here or click to select</div>
          <div class="text-xs text-gray-500 mt-1">Max ~20MB recommended. Large documents may take a bit longer.</div>
          <input id="fileInput" type="file" accept="application/pdf" class="sr-only"/>
        </label>

        <div class="mt-3">
          <button id="chooseBtn" class="bg-pink-600 text-white font-semibold rounded-full py-2 px-5 hover:bg-pink-700">
            Select PDF
          </button>
          <div class="text-xs text-gray-500 mt-2" data-i18n="common.or_drop">or drag & drop</div>
        </div>
      </div>

      <!-- 已选择文件信息 -->
      <div id="fileInfo" class="mt-6 hidden">
        <div class="flex items-center justify-between">
          <div>
            <div id="fileName" class="font-medium"></div>
            <div id="fileSize" class="text-xs text-gray-500"></div>
          </div>
          <button id="replaceBtn" class="text-sm px-3 py-1 rounded border hover:bg-gray-50">Replace file</button>
        </div>

        <!-- 预览 + 选项 -->
        <div class="mt-4">
          <p class="text-sm text-gray-600 mb-2">
            A plain-text preview is shown below. Layout won’t be perfect, but the content is editable in Word.
          </p>
          <div id="pdfPreview" class="text-gray-800 text-sm">
            <p class="text-gray-500 text-sm">Waiting for text extraction…</p>
          </div>

          <div class="mt-4 flex flex-wrap items-center gap-4 text-sm">
            <label class="flex items-center space-x-2">
              <input id="optIncludePageBreak" type="checkbox" class="form-checkbox" checked>
              <span>Insert page breaks between PDF pages</span>
            </label>
          </div>

          <div class="mt-6">
            <button id="runBtn" class="bg-pink-600 text-white font-bold rounded-full py-2.5 px-6">
              Convert to Word (.docx)
            </button>
            <p id="runMsg" class="mt-2 text-sm text-gray-500 hidden">
              Converting… extracting text locally with pdf.js.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Ad: tool_mid_display -->
    <div class="mt-6">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-4284929103244648"
           data-ad-slot="7530331224"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
    </div>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

    <!-- 文本说明区 -->
    <section class="mt-10 text-sm md:text-base leading-relaxed text-gray-700 space-y-4">
      <h2 class="text-xl font-semibold">About this PDF to Word converter</h2>
      <p>
        This tool focuses on <strong>text-based PDFs</strong>. It uses <code>pdf.js</code> to extract text content from each
        page, then builds a clean HTML document and converts it to a Word <code>.docx</code> file using
        <code>html-docx-js</code>. The output is not a pixel-perfect clone of the PDF, but rather an
        <strong>editable document</strong> that you can freely modify in Microsoft Word, WPS, or LibreOffice.
      </p>
      <p>
        Because everything runs in your browser, your PDF never leaves your device. This is ideal for contracts, reports,
        manuals, and other documents where text extraction matters more than visual perfection.
      </p>
      <p class="text-gray-500 text-xs">
        Note: scanned PDFs that contain only images (no embedded text) cannot be converted with this tool. They would
        require OCR, which is not performed here.
      </p>
    </section>
  </main>

  <!-- More tools -->
  <section class="max-w-6xl mx-auto px-4 py-12">
    <h2 class="text-2xl font-bold mb-4">More PDF tools</h2>
    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm">
      <a href="/tools/pdf-merge.html" class="text-pink-600 hover:underline">Merge PDF</a>
      <a href="/tools/pdf-split.html" class="text-pink-600 hover:underline">Split PDF</a>
      <a href="/tools/pdf-compress.html" class="text-pink-600 hover:underline">Compress PDF</a>
      <a href="/tools/pdf-to-jpg.html" class="text-pink-600 hover:underline">PDF to JPG</a>
      <a href="/tools/docx-to-pdf.html" class="text-pink-600 hover:underline">Word to PDF</a>
      <a href="/tools/pdf-to-docx.html" class="text-pink-600 hover:underline">PDF to Word</a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-white border-t">
    <div class="max-w-6xl mx-auto px-4">
      <div class="w-full flex flex-col md:flex-row py-8 gap-8 text-sm">
        <div class="flex-1">
          <div class="text-pink-600 font-extrabold text-2xl">DocPDFHub</div>
          <p class="text-gray-500 mt-2" data-i18n="footer.tagline">Free & private PDF tools in your browser.</p>
          <p class="text-gray-400 mt-2" data-i18n="common.100_local">100% local in your browser • No upload</p>
        </div>
        <div class="flex-1">
          <p class="uppercase text-gray-500 mb-3" data-i18n="footer.tools">Tools</p>
          <ul class="space-y-2">
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-merge.html" data-i18n="nav.merge">Merge PDF</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-split.html" data-i18n="nav.split">Split PDF</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-compress.html" data-i18n="nav.compress">Compress PDF</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-to-jpg.html" data-i18n="nav.tojpg">PDF to JPG</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/docx-to-pdf.html" data-i18n="nav.topdf">Word to PDF</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-to-docx.html" data-i18n="nav.toword">PDF to Word</a></li>
          </ul>
        </div>
        <div class="flex-1">
          <p class="uppercase text-gray-500 mb-3" data-i18n="footer.company">Company</p>
          <ul class="space-y-2">
            <li><a class="text-gray-700 hover:text-pink-600" href="/about.html" data-i18n="footer.about">About Us</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/blog/index.html" data-i18n="footer.blog">Official Blog</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="mailto:langer.lee@gmail.com" data-i18n="footer.contact">Contact</a></li>
          </ul>
        </div>
        <div class="flex-1">
          <p class="uppercase text-gray-500 mb-3" data-i18n="footer.legal">Legal</p>
          <ul class="space-y-2">
            <li><a class="text-gray-700 hover:text-pink-600" href="/terms.html" data-i18n="footer.terms">Terms</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/privacy.html">Privacy</a></li>
          </ul>
        </div>
      </div>
      <div class="py-4 border-t text-xs text-gray-400">© <span id="y"></span> DocPDFHub</div>
    </div>
  </footer>

  <!-- Logic -->
  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js";

    const $ = s => document.querySelector(s);

    const dropZone = $('#dropZone');
    const fileInput = $('#fileInput');
    const chooseBtn = $('#chooseBtn');
    const replaceBtn = $('#replaceBtn');
    const fileInfo = $('#fileInfo');
    const fileNameEl = $('#fileName');
    const fileSizeEl = $('#fileSize');
    const previewEl = $('#pdfPreview');
    const runBtn = $('#runBtn');
    const runMsg = $('#runMsg');
    const optIncludePageBreak = $('#optIncludePageBreak');

    let file = null;
    let extractedText = ''; // 所有页的合并文本

    function fmtBytes(n){
      const u=['B','KB','MB','GB'];let i=0;
      while(n>=1024 && i<u.length-1){n/=1024;i++;}
      return n.toFixed(n<10&&i?1:0)+' '+u[i];
    }

    function showInfo(){
      fileInfo.classList.toggle('hidden', !file);
      if(file){
        fileNameEl.textContent = file.name;
        fileSizeEl.textContent = fmtBytes(file.size);
      }
    }

    // 拖拽状态
    ['dragenter','dragover'].forEach(evt=>{
      dropZone.addEventListener(evt, e=>{
        e.preventDefault(); e.stopPropagation();
        dropZone.classList.add('drop-active');
      });
    });
    ['dragleave','drop'].forEach(evt=>{
      dropZone.addEventListener(evt, e=>{
        e.preventDefault(); e.stopPropagation();
        dropZone.classList.remove('drop-active');
      });
    });

    dropZone.addEventListener('drop', e=>{
      const fs = Array.from(e.dataTransfer.files || [])
        .filter(f => /\.pdf$/i.test(f.name));
      if(fs[0]){
        file = fs[0];
        showInfo();
        extractPdfText();
      }else if((e.dataTransfer.files || []).length){
        alert('Please choose a PDF file.');
      }
    });

    fileInput.addEventListener('change', ()=>{
      const fs = Array.from(fileInput.files || [])
        .filter(f => /\.pdf$/i.test(f.name));
      if(fs[0]){
        file = fs[0];
        showInfo();
        extractPdfText();
      }else if((fileInput.files || []).length){
        alert('Please choose a PDF file.');
      }
      fileInput.value = '';
    });

    chooseBtn.addEventListener('click', ()=> fileInput.click());
    replaceBtn.addEventListener('click', ()=> fileInput.click());

    function readAB(f){
      return new Promise((res,rej)=>{
        const r = new FileReader();
        r.onload = ()=> res(r.result);
        r.onerror = rej;
        r.readAsArrayBuffer(f);
      });
    }

    async function extractPdfText(){
      previewEl.textContent = 'Extracting text from PDF…';
      extractedText = '';

      if(!file) return;

      try{
        const data = await readAB(file);
        const loadingTask = pdfjsLib.getDocument({ data });
        const pdf = await loadingTask.promise;

        let allLines = [];
        for(let pageNum=1; pageNum<=pdf.numPages; pageNum++){
          const page = await pdf.getPage(pageNum);
          const content = await page.getTextContent();
          const strings = content.items.map(item => item.str || '').filter(Boolean);
          const pageText = strings.join(' ');
          const trimmed = pageText.replace(/\s+\n/g, '\n').trim();

          if(trimmed){
            allLines.push('--- Page '+pageNum+' ---');
            allLines.push(trimmed);
            allLines.push(''); // 空行
          }
        }

        extractedText = allLines.join('\n');

        if(!extractedText.trim()){
          previewEl.innerHTML =
            '<p class="text-sm text-red-500">No extractable text was found. This PDF may be scanned or image-only. OCR is not supported in this tool.</p>';
        }else{
          previewEl.textContent = extractedText;
        }

      }catch(err){
        console.error(err);
        previewEl.innerHTML =
          '<p class="text-sm text-red-500">Failed to read this PDF. Please make sure it is not password-protected or corrupted.</p>';
      }
    }

    function escapeHtml(str){
      return String(str).replace(/[&<>"]/g, c => ({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'
      }[c] || c));
    }

    async function convertToWord(){
      if(!file){
        alert('Please add a PDF file to convert.');
        return;
      }

      if(!extractedText.trim()){
        // 再尝试一次提取
        await extractPdfText();
        if(!extractedText.trim()){
          alert('No text could be extracted from this PDF. It may be scanned or image-only.');
          return;
        }
      }

      runMsg.classList.remove('hidden');
      runBtn.disabled = true;
      if(window.DocPDFHub && DocPDFHub.Progress){
        DocPDFHub.Progress.show();
        DocPDFHub.Progress.set(20);
      }

      try{
        const raw = extractedText;
        const includePageBreak = optIncludePageBreak.checked;

        // 把 " --- Page X --- " 这种分割，转成 <h2> 和 page-break
        const lines = raw.split('\n');
        let htmlBody = '';
        let buffer = [];
        let pageIndex = 0;

        const flushParagraphs = ()=>{
          if(buffer.length){
            htmlBody += '<p>'+ escapeHtml(buffer.join(' ').trim()) +'</p>\n';
            buffer = [];
          }
        };

        for(const line of lines){
          const m = line.match(/^--- Page (\d+) ---$/);
          if(m){
            flushParagraphs();
            pageIndex++;
            if(pageIndex > 1 && includePageBreak){
              htmlBody += '<p style="page-break-before: always;"></p>\n';
            }
            htmlBody += '<h2>Page '+ pageIndex +'</h2>\n';
          }else if(line.trim()===''){
            flushParagraphs();
          }else{
            buffer.push(line.trim());
          }
        }
        flushParagraphs();

        if(!htmlBody.trim()){
          htmlBody = '<p>(No text extracted)</p>';
        }

        const fullHtml =
          '<!DOCTYPE html><html><head><meta charset="utf-8">' +
          '<title>'+ escapeHtml(file.name) +'</title>' +
          '<style>body{font-family:Arial,Helvetica,sans-serif;font-size:12pt;line-height:1.5;}</style>' +
          '</head><body>' +
          '<h1>'+ escapeHtml(file.name.replace(/\.pdf$/i,'')) +'</h1>' +
          htmlBody +
          '</body></html>';

        if(typeof htmlDocx === 'undefined' || !htmlDocx.asBlob){
          alert('Word converter library failed to load. Please refresh and try again.');
          return;
        }

        const docxBlob = htmlDocx.asBlob(fullHtml);
        const a = document.createElement('a');
        a.href = URL.createObjectURL(docxBlob);
        a.download = file.name.replace(/\.pdf$/i,'') + '.docx';
        a.click();
        URL.revokeObjectURL(a.href);

      }catch(err){
        console.error(err);
        alert('Failed to convert to Word. Please try again with another file.');
      }finally{
        runMsg.classList.add('hidden');
        runBtn.disabled = false;
        if(window.DocPDFHub && DocPDFHub.Progress){
          DocPDFHub.Progress.set(100);
          setTimeout(()=> DocPDFHub.Progress.hide(), 300);
        }
      }
    }

    runBtn.addEventListener('click', convertToWord);

    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('/service-worker.js').catch(()=>{});
    }
  </script>
</body>
</html>
