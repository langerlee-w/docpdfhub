<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <meta http-equiv="X-UA-Compatible" content="ie=edge"/>

  <!-- 结构化数据：Organization -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "DocPDFHub",
    "url": "https://docpdfhub.com",
    "logo": "https://docpdfhub.com/icon-512.png",
    "sameAs": []
  }
  </script>

  <!-- 结构化数据：WebSite -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://docpdfhub.com",
    "name": "DocPDFHub",
    "inLanguage": "en",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://docpdfhub.com/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <!-- SEO -->
  <title>PDF to Word Converter — Free, No Upload | DocPDFHub</title>
  <meta name="description" content="Convert PDF to editable Word (.docx) directly in your browser. Text-only PDFs supported. 100% local processing, no file upload.">

  <link rel="canonical" href="https://docpdfhub.com/tools/pdf-to-word.html">
  <link rel="alternate" href="https://docpdfhub.com/tools/pdf-to-word.html" hreflang="x-default">
  <link rel="alternate" href="https://docpdfhub.com/tools/pdf-to-word.html" hreflang="en">
  <link rel="alternate" href="https://docpdfhub.com/zh/tools/pdf-to-word.html" hreflang="zh">

  <!-- 样式 -->
  <link rel="stylesheet" href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css"/>
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet"/>

  <!-- libs：pdf.js + docx（浏览器 UMD 版）-->
  <script src="https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
  <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>

  <!-- 全站 i18n & 通用 JS（如果路径不同按你现有项目改） -->
  <script src="/js/i18n.js" defer></script>
  <script src="/js/common.js" defer></script>

  <style>
    .gradient{background:linear-gradient(90deg,#d53369 0%,#daae51 100%)}
    .dropzone{border:2px dashed #e5e7eb;}
    .drop-active{outline:2px dashed #ec4899; outline-offset:6px; background:#fff7fb}
  </style>

  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#ec4899">
  <link rel="alternate" href="https://docpdfhub.com/" hreflang="x-default">
  <link rel="alternate" href="https://docpdfhub.com/" hreflang="en">
  <link rel="alternate" href="https://docpdfhub.com/" hreflang="zh">

  <!-- AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4284929103244648"
     crossorigin="anonymous"></script>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-3W6M25B9FL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-3W6M25B9FL');
  </script>
</head>

<body class="text-gray-900 bg-gray-50" style="font-family:'Source Sans Pro',sans-serif;">

  <!-- Nav -->
  <nav class="fixed w-full z-30 top-0 bg-white shadow">
    <div class="w-full max-w-6xl mx-auto flex items-center justify-between px-4 py-3">
      <a class="text-pink-600 font-extrabold text-2xl" href="/"><span data-i18n="common.brand">DocPDFHub</span></a>
      <div class="hidden md:flex items-center space-x-6 text-sm">
        <a href="/" class="text-gray-700 hover:text-pink-600" data-i18n="nav.home">Home</a>
        <a href="/blog/index.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.blog">Blog</a>
        <a href="/tools/pdf-merge.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.merge">Merge PDF</a>
        <a href="/tools/pdf-split.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.split">Split PDF</a>
        <a href="/tools/pdf-compress.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.compress">Compress PDF</a>
        <a href="/tools/pdf-to-jpg.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.tojpg">PDF to JPG</a>
        <a href="/tools/docx-to-pdf.html" class="text-gray-700 hover:text-pink-600" data-i18n="nav.topdf">Word to PDF</a>
        <a href="/tools/pdf-to-word.html" class="text-gray-900 font-semibold" data-i18n="nav.toword">PDF to Word</a>
        <div class="flex items-center space-x-2">
          <button data-lang-btn="en" class="px-2 py-1 rounded hover:bg-gray-100">EN</button>
          <span class="text-gray-300">|</span>
          <button data-lang-btn="zh" class="px-2 py-1 rounded hover:bg-gray-100">中文</button>
        </div>
      </div>
      <!-- 移动端语言按钮（简化） -->
      <div class="md:hidden flex items-center space-x-2">
        <button data-lang-btn="en" class="px-2 py-1 rounded hover:bg-gray-100">EN</button>
        <button data-lang-btn="zh" class="px-2 py-1 rounded hover:bg-gray-100">中文</button>
      </div>
    </div>
  </nav>
  <div class="pt-20"></div>

  <!-- Hero -->
  <header class="gradient text-white pt-12 pb-10">
    <div class="max-w-6xl mx-auto px-4">
      <p class="uppercase tracking-widest opacity-90 text-sm" data-i18n="home.hero_kicker">PDF TOOLS</p>
      <h1 class="text-4xl md:text-5xl font-extrabold mt-2" data-i18n="tool.toword.hero.title">PDF to Word</h1>
      <p class="text-white text-opacity-90 mt-2 md:w-3/4" data-i18n="tool.toword.hero.subtitle">
        Convert text-based PDFs into editable Word documents — fully in your browser.
      </p>
      <p class="mt-3 text-sm text-white text-opacity-80" data-i18n="common.100_local">100% local in your browser • No upload</p>
    </div>
  </header>

  <!-- Main -->
  <main class="max-w-6xl mx-auto px-4 py-10">
    <div id="dropZone" class="bg-white border rounded-xl p-6 shadow-sm">
      <div class="text-center">
        <h2 class="text-xl font-bold" data-i18n="tool.toword.drop.title">Drop a PDF to convert</h2>
        <p class="text-gray-600 mt-1" data-i18n="tool.toword.drop.hint">
          Works best with text-based PDFs. Scanned/image-only PDFs are not supported.
        </p>

        <!-- 拖拽 + 点击上传 -->
        <label for="fileInput" class="block mt-4 p-6 border rounded-xl dropzone cursor-pointer">
          <div class="font-semibold" data-i18n="uploader.title">Drop files here or click to select</div>
          <div class="text-xs text-gray-500 mt-1" data-i18n="uploader.hint">Max 100MB each. Your files never leave your device.</div>
          <input id="fileInput" type="file" accept="application/pdf" class="sr-only"/>
        </label>

        <div class="mt-3">
          <button id="chooseBtn" class="bg-pink-600 text-white font-semibold rounded-full py-2 px-5 hover:bg-pink-700"
            data-i18n="tool.toword.drop.button">Select PDF</button>
          <div class="text-xs text-gray-500 mt-2" data-i18n="common.or_drop">or drag & drop</div>
        </div>
      </div>

      <!-- 已选择文件信息 -->
      <div id="fileInfo" class="mt-6 hidden">
        <div class="flex items-center justify-between">
          <div>
            <div id="fileName" class="font-medium"></div>
            <div id="fileSize" class="text-xs text-gray-500"></div>
          </div>
          <button id="replaceBtn" class="text-sm px-3 py-1 rounded border hover:bg-gray-50" data-i18n="tool.toword.options.add_more">Replace file</button>
        </div>

        <!-- 选项 -->
        <div class="grid md:grid-cols-2 gap-4 mt-4">
          <label class="flex items-center space-x-2">
            <input id="includePageHeading" type="checkbox" class="form-checkbox h-4 w-4" checked/>
            <span class="text-sm" data-i18n="tool.toword.options.include_page_heading">Add “Page 1, Page 2…” headings</span>
          </label>
          <label class="flex items-center space-x-2">
            <input id="pageBreaks" type="checkbox" class="form-checkbox h-4 w-4" checked/>
            <span class="text-sm" data-i18n="tool.toword.options.page_breaks">Insert page breaks between PDF pages</span>
          </label>
        </div>

        <!-- 运行 -->
        <div class="mt-6">
          <button id="runBtn" class="bg-pink-600 text-white font-bold rounded-full py-2.5 px-6" data-i18n="tool.toword.actions.convert">Convert to Word</button>
          <p id="runMsg" class="mt-2 text-sm text-gray-500 hidden">
            <span data-i18n="tool.toword.running.status">Converting to Word…</span>
            <span class="ml-1" data-i18n="tool.toword.running.tip">Text is extracted locally and saved into a .docx file.</span>
          </p>
        </div>
      </div>
    </div>

    <!-- 广告位 -->
    <div class="mt-6">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-4284929103244648"
           data-ad-slot="7530331224"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
    </div>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

    <!-- 工具说明 / SEO 文本 -->
    <section class="mt-12 text-sm text-gray-700 space-y-4">
      <h2 class="text-xl font-semibold">About PDF to Word conversion</h2>
      <p>
        This tool focuses on <strong>text-based PDFs</strong> — documents where you can select and copy text in a normal PDF viewer.
        It extracts text directly from the PDF and writes it into an editable Word document. Because everything runs in your browser,
        sensitive documents never leave your device.
      </p>
      <p>
        Scanned PDFs or image-only documents currently cannot be converted to real editable text without OCR.
        For those files, you may first process them with an OCR tool to make the text selectable, and then re-run this converter.
      </p>
    </section>
  </main>

    <!-- More tools -->
  <section class="max-w-6xl mx-auto px-4 py-12">
    <h2 class="text-2xl font-bold mb-4">More PDF tools</h2>
    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm">
      <a href="/tools/pdf-merge.html" class="text-pink-600 hover:underline">Merge PDF</a>
      <a href="/tools/pdf-split.html" class="text-pink-600 hover:underline">Split PDF</a>
      <a href="/tools/pdf-compress.html" class="text-pink-600 hover:underline">Compress PDF</a>
      <a href="/tools/pdf-to-jpg.html" class="text-pink-600 hover:underline">PDF to JPG</a>
      <a href="/tools/docx-to-pdf.html" class="text-pink-600 hover:underline">Word to PDF</a>
      <a href="/tools/pdf-to-docx.html" class="text-pink-600 hover:underline">PDF to Word</a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-white border-t">
    <div class="max-w-6xl mx-auto px-4">
      <div class="w-full flex flex-col md:flex-row py-8 gap-8 text-sm">
        <div class="flex-1">
          <div class="text-pink-600 font-extrabold text-2xl">DocPDFHub</div>
          <p class="text-gray-500 mt-2" data-i18n="footer.tagline">Free & private PDF tools in your browser.</p>
          <p class="text-gray-400 mt-2" data-i18n="common.100_local">100% local in your browser • No upload</p>
        </div>
        <div class="flex-1">
          <p class="uppercase text-gray-500 mb-3" data-i18n="footer.tools">Tools</p>
          <ul class="space-y-2">
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-merge.html" data-i18n="nav.merge">Merge PDF</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-split.html" data-i18n="nav.split">Split PDF</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-compress.html" data-i18n="nav.compress">Compress PDF</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-to-jpg.html" data-i18n="nav.tojpg">PDF to JPG</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/docx-to-pdf.html" data-i18n="nav.topdf">Word to PDF</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/tools/pdf-to-word.html" data-i18n="nav.toword">PDF to Word</a></li>
          </ul>
        </div>
        <div class="flex-1">
          <p class="uppercase text-gray-500 mb-3" data-i18n="footer.company">Company</p>
          <ul class="space-y-2">
            <li><a class="text-gray-700 hover:text-pink-600" href="/about.html" data-i18n="footer.about">About Us</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/blog/index.html" data-i18n="footer.blog">Official Blog</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="mailto:langer.lee@gmail.com" data-i18n="footer.contact">Contact</a></li>
          </ul>
        </div>
        <div class="flex-1">
          <p class="uppercase text-gray-500 mb-3" data-i18n="footer.legal">Legal</p>
          <ul class="space-y-2">
            <li><a class="text-gray-700 hover:text-pink-600" href="/terms.html" data-i18n="footer.terms">Terms</a></li>
            <li><a class="text-gray-700 hover:text-pink-600" href="/privacy.html">Privacy</a></li>
          </ul>
        </div>
      </div>
      <div class="py-4 border-t text-xs text-gray-400">
        © <span id="y"></span> DocPDFHub
      </div>
    </div>
  </footer>

  <!-- 核心逻辑脚本 -->
  <script>
    // 年份
    document.getElementById('y').textContent = new Date().getFullYear();

    // pdf.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = "https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js";

    const $ = s => document.querySelector(s);
    const dropZone = document.getElementById('dropZone');
    const fileInput = $('#fileInput');
    const chooseBtn = $('#chooseBtn');
    const replaceBtn = $('#replaceBtn');
    const fileInfo = $('#fileInfo');
    const fileNameEl = $('#fileName');
    const fileSizeEl = $('#fileSize');
    const includePageHeading = $('#includePageHeading');
    const pageBreaks = $('#pageBreaks');
    const runBtn = $('#runBtn');
    const runMsg = $('#runMsg');

    let file = null;

    document.addEventListener('DOMContentLoaded', ()=>{
      // 还原上次选项（如果 common.js 里有 DocPDFHub.Store）
      if (window.DocPDFHub && DocPDFHub.Store) {
        const last = DocPDFHub.Store.get('toword_opts', { includePageHeading:true, pageBreaks:true });
        includePageHeading.checked = !!last.includePageHeading;
        pageBreaks.checked = !!last.pageBreaks;
      }
    });

    function fmtBytes(n){
      if (window.DocPDFHub && DocPDFHub.fmtBytes) return DocPDFHub.fmtBytes(n);
      const u=['B','KB','MB','GB'];let i=0;while(n>=1024&&i<u.length-1){n/=1024;i++}return n.toFixed(n<10&&i?1:0)+' '+u[i];
    }

    function persistOptions(){
      if (!(window.DocPDFHub && DocPDFHub.Store)) return;
      DocPDFHub.Store.set('toword_opts', {
        includePageHeading: !!includePageHeading.checked,
        pageBreaks: !!pageBreaks.checked
      });
    }

    function showInfo(){
      fileInfo.classList.toggle('hidden', !file);
      if(file){
        fileNameEl.textContent = file.name;
        fileSizeEl.textContent = fmtBytes(file.size);
      }
    }

    // 拖拽
    ['dragenter','dragover'].forEach(evt=>{
      dropZone.addEventListener(evt, e=>{ e.preventDefault(); e.stopPropagation(); dropZone.classList.add('drop-active'); });
    });
    ['dragleave','drop'].forEach(evt=>{
      dropZone.addEventListener(evt, e=>{ e.preventDefault(); e.stopPropagation(); dropZone.classList.remove('drop-active'); });
    });
    dropZone.addEventListener('drop', (e)=>{
      const fs = Array.from(e.dataTransfer.files||[]).filter(f=>/pdf$/i.test(f.name));
      if (fs[0]){ file = fs[0]; showInfo(); }
    });

    // 选择文件
    fileInput.addEventListener('change', ()=>{
      const fs = Array.from(fileInput.files||[]).filter(f=>/pdf$/i.test(f.name));
      if (fs[0]){ file = fs[0]; showInfo(); }
      fileInput.value = '';
    });

    chooseBtn.addEventListener('click', ()=> fileInput.click());
    replaceBtn.addEventListener('click', ()=> fileInput.click());

    const readAB = (f)=> new Promise((res,rej)=>{
      const r=new FileReader();
      r.onload=()=>res(r.result);
      r.onerror=rej;
      r.readAsArrayBuffer(f);
    });

    // 更稳的文本提取函数
    async function extractPdfText(arrayBuffer) {
      const loadingTask = pdfjsLib.getDocument({
        data: arrayBuffer,
        verbosity: 0
      });
      const pdf = await loadingTask.promise;
      let pages = [];

      for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
        const page = await pdf.getPage(pageNum);
        const textContent = await page.getTextContent({
          includeMarkedContent: true
        });

        const pageText = textContent.items
          .map(item => {
            if ("str" in item && item.str) {
              return item.hasEOL ? item.str + "\n" : item.str;
            }
            return "";
          })
          .join("");

        pages.push(pageText.trim());
      }

      const full = pages.filter(Boolean).join("\n\n");
      return { pages, full: full.trim() };
    }

    async function convertToWord(){
      if(!file){
        alert(window.__i18n__?.t('tool.toword.errors.no_pdf') || 'Please add a PDF to convert.');
        return;
      }

      runMsg.classList.remove('hidden');
      runBtn.disabled = true;
      persistOptions();

      // 可选：进度条（如果你在 common.js 里实现了 DocPDFHub.Progress）
      if (window.DocPDFHub && DocPDFHub.Progress) {
        DocPDFHub.Progress.show();
        DocPDFHub.Progress.set(5);
      }

      try {
        const srcBytes = await readAB(file);
        const { pages, full } = await extractPdfText(srcBytes);

        if (!full) {
          alert(window.__i18n__?.t('tool.toword.errors.no_text') ||
            'No text could be extracted from this PDF. It may be scanned or image-only.');
          return;
        }

        // 生成 docx
        const docxLib = window.docx;
        if (!docxLib) {
          alert('docx library not loaded.');
          return;
        }
        const { Document, Packer, Paragraph, TextRun, HeadingLevel } = docxLib;

        let children = [];
        const withHeading = !!includePageHeading.checked;
        const withPageBreaks = !!pageBreaks.checked;

        pages.forEach((pageText, idx) => {
          if (!pageText.trim()) return;

          if (withHeading) {
            children.push(new Paragraph({
              text: `Page ${idx + 1}`,
              heading: HeadingLevel.HEADING_2,
              spacing: { after: 200 }
            }));
          }

          pageText.split(/\r?\n/).forEach(line => {
            children.push(new Paragraph(line));
          });

          if (withPageBreaks && idx < pages.length - 1) {
            children.push(
              new Paragraph({
                children: [ new TextRun({ text: "", break: 1 }) ],
                pageBreakBefore: true
              })
            );
          }
        });

        if (!children.length) {
          children.push(new Paragraph('No text content detected.'));
        }

        const doc = new Document({
          sections: [{ children }]
        });

        const blob = await Packer.toBlob(doc);
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        const baseName = file.name.replace(/\.pdf$/i,'') || 'converted';
        a.download = baseName + '.docx';
        a.click();
        URL.revokeObjectURL(a.href);

        alert(window.__i18n__?.t('tool.toword.result.title') || 'Conversion complete');
      } catch (err) {
        console.error(err);
        alert('Failed to convert this PDF. Please try another file.');
      } finally {
        runMsg.classList.add('hidden');
        runBtn.disabled = false;
        if (window.DocPDFHub && DocPDFHub.Progress) {
          DocPDFHub.Progress.set(100);
          setTimeout(()=>DocPDFHub.Progress.hide(), 300);
        }
      }
    }

    runBtn.addEventListener('click', convertToWord);

    // 注册 service worker（与站点其他页保持一致）
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js').catch(()=>{});
    }
  </script>
</body>
</html>
